syntax = "proto3";
package provenance.authz.v1;

import "google/api/annotations.proto";
import "cosmos/base/query/v1beta1/pagination.proto";
import "provenance/authz/v1/authz.proto";

option go_package = "github.com/provenance-io/provenance/x/authz/types";

option java_package        = "io.provenance.authz.v1";
option java_multiple_files = true;

// Query defines the gRPC querier service.
service Query {
  // Returns any `Authorization` (or `nil`), with the expiration time, granted to the grantee by the granter for the
  // provided msg type.
  rpc Authorization(QueryAuthorizationRequest) returns (QueryAuthorizationResponse) {
    option (google.api.http).get = "/provenance/authz/v1/granters/{granter}/grantees/{grantee}/grant";
  }

  // Returns list of `Authorization`, granted to the grantee by the granter.
  rpc Authorizations(QueryAuthorizationsRequest) returns (QueryAuthorizationsResponse) {
    option (google.api.http).get = "/provenance/authz/v1/granters/{granter}/grantees/{grantee}/grants";
  }
}

// QueryAuthorizationRequest is the request type for the Query/Authorization RPC method.
message QueryAuthorizationRequest {
  string granter     = 1;
  string grantee     = 2;
  string method_name = 3;
}

// QueryAuthorizationResponse is the response type for the Query/Authorization RPC method.
message QueryAuthorizationResponse {
  // authorization is a authorization granted for grantee by granter.
  provenance.authz.v1.AuthorizationGrant authorization = 1;
}

// QueryAuthorizationsRequest is the request type for the Query/Authorizations RPC method.
message QueryAuthorizationsRequest {
  string granter = 1;
  string grantee = 2;
  // pagination defines an pagination for the request.
  cosmos.base.query.v1beta1.PageRequest pagination = 3;
}

// QueryAuthorizationsResponse is the response type for the Query/Authorizations RPC method.
message QueryAuthorizationsResponse {
  // authorizations is a list of grants granted for grantee by granter.
  repeated provenance.authz.v1.AuthorizationGrant authorizations = 1;
  // pagination defines an pagination for the response.
  cosmos.base.query.v1beta1.PageResponse pagination = 2;
}
